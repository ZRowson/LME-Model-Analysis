"0","# Evaluate predicted value at t=-9.5"
"0","conc <- levels(lmm1.D$data$conc)"
"0","t <- -9.5"
"0","new_data <- expand.grid(t=t, conc=conc)"
"0",""
"0","# Predict"
"0","new_data$pred <- predict(lmm1.D, new_data, level=0)"
"0",""
"0","# Extract model matrix for the data being fit, and use to extract varCov matrix of predictions"
"0","designMat <- model.matrix(formula(lmm1.D)[-2], new_data)"
"0","predVar <- diag(designMat %*% vcov(lmm1.D) %*% t(designMat))"
"0","new_data$SE <- sqrt(predVar)"
"0","new_data$SE_pred <- sqrt(predVar + (lmm1.D$sigma)^2)"
"0",""
"0","# Plot confidence intervals"
"0","cmult <- 2"
"0","new_data$logConc <- log10( as.numeric(levels(new_data$conc)) )"
"0","ggplot(new_data, aes(x=logConc,y=pred)) +"
"0","  geom_point() +"
"0","  geom_errorbar(aes(ymin=pred-cmult*SE,ymax=pred+cmult*SE)) +"
"0","  labs(title=""Model Fitted Value at Initial Time Period"")"
