"0","# Evaluate predicted value at t=-9.5"
"0","lme_fit_0 <- function(model, t) {"
"0","  conc <- levels(model$data$conc)"
"0","  new_data <- expand.grid(t=t, conc=conc)"
"0","  "
"0","  # Predict"
"0","  new_data$pred <- predict(model, new_data, level=0)"
"0","  "
"0","  # Extract model matrix for the data being fit, and use to extract varCov matrix of predictions"
"0","  designMat <- model.matrix(formula(model)[-2], new_data)"
"0","  predVar <- diag(designMat %*% vcov(model) %*% t(designMat))"
"0","  "
"0","  # Caluclate SEs of fitted value and calculate CIs"
"0","  new_data$SE <- sqrt(predVar)"
"0","  new_data$upper <- new_data$pred + (2*new_data$SE)"
"0","  new_data$lower <- new_data$pred - (2*new_data$SE)"
"0","  "
"0","  return(new_data)"
"0","}"
